<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/876d048b5dab7c28.css" as="style"/><link rel="stylesheet" href="/_next/static/css/876d048b5dab7c28.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-59c5c889f52620d6.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-f11614d8aa7ee555.js" defer=""></script><script src="/_next/static/chunks/pages/_app-bf55c49910772dbb.js" defer=""></script><script src="/_next/static/chunks/9f96d65d-c9e0543547ce45e9.js" defer=""></script><script src="/_next/static/chunks/557-10798b428373902a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-a468c6c0f66f2931.js" defer=""></script><script src="/_next/static/HXrOUhiN06_k-DjdnFR0c/_buildManifest.js" defer=""></script><script src="/_next/static/HXrOUhiN06_k-DjdnFR0c/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><p>最近的一个月左右，我开始尝试做我的第一个真正具有实用价值的前端项目—— WebGAL 。在这个项目中，我使用了 React 作为我的前端框架。但是项目初期，我却没有使用 create-react-app 生成一个 React 项目，而是选择了静态引入 React 和 ReactDOM 作为一个静态网页的代码，然后再在一个单文件里写主要的业务代码，所有的存储管理、渲染、交互处理都在一个文件里进行。后来，随着开发的进度，我的文件已经达到了1000多行，并且有朝着2000行奔去的架势。所以，将模块拆分、重构，几乎是必然的了。</p>
<p>在一开始的重构中，我只是粗暴地将业务代码按函数的功能分开了，但是却仍然用静态引入的方式在HTML中按照顺序分别引入了。这很显然是不合理的，因为这四舍五入等于没重构，顶多算是拆了下文件。后来当我试图如法炮制，创建了一个 React 项目并将其放入后，却出现了浩如烟海的 bug 。很显然，之前我飞全局变量的那一套不管用了。</p>
<p>为了能够让各个模块都能良好地访问页面中的全局变量，我重新分出了一个类，用来管理存储与全局变量。这样一来，其他的模块只需要访问这个类的函数，就可以得到它们所需要的全局变量。然后，这个类再将其与 LocalStorage 同步。</p>
<p>然后就是关于渲染的统一控制。在重构后的版本中，所有的渲染都通过一个专门用来控制渲染的类 ViewControl 来实现。这样一来，就可以降低业务代码与渲染视图之间的耦合度，让各个模块各司其职，同时也保证了代码的简洁。</p>
<p>重构这个项目是一个漫长且痛苦的过程，因为我先前写的架构实在是过于混乱不堪了。不同模块之间、不同函数之间，充斥着随便的全局变量读写与杂乱无章的相互调用。实际上，在现在的版本中，许多问题并没有得到完全改善，所以在接下来的工作中，还需要继续优化以改善现有项目的结构状况。</p></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":"---\r\nlayout:     post\r\ntitle:      记一次前端项目的踩坑与开发经验\r\nintro:   \"\"\r\ndate:       2021-10-24 12:00:01\r\nauthor:     \"Makinohara\"\r\ncatalog: true\r\ntags:\r\n    - 工程开发\r\n    \r\n---\r\n\r\n最近的一个月左右，我开始尝试做我的第一个真正具有实用价值的前端项目—— WebGAL 。在这个项目中，我使用了 React 作为我的前端框架。但是项目初期，我却没有使用 create-react-app 生成一个 React 项目，而是选择了静态引入 React 和 ReactDOM 作为一个静态网页的代码，然后再在一个单文件里写主要的业务代码，所有的存储管理、渲染、交互处理都在一个文件里进行。后来，随着开发的进度，我的文件已经达到了1000多行，并且有朝着2000行奔去的架势。所以，将模块拆分、重构，几乎是必然的了。\r\n\r\n在一开始的重构中，我只是粗暴地将业务代码按函数的功能分开了，但是却仍然用静态引入的方式在HTML中按照顺序分别引入了。这很显然是不合理的，因为这四舍五入等于没重构，顶多算是拆了下文件。后来当我试图如法炮制，创建了一个 React 项目并将其放入后，却出现了浩如烟海的 bug 。很显然，之前我飞全局变量的那一套不管用了。\r\n\r\n为了能够让各个模块都能良好地访问页面中的全局变量，我重新分出了一个类，用来管理存储与全局变量。这样一来，其他的模块只需要访问这个类的函数，就可以得到它们所需要的全局变量。然后，这个类再将其与 LocalStorage 同步。\r\n\r\n然后就是关于渲染的统一控制。在重构后的版本中，所有的渲染都通过一个专门用来控制渲染的类 ViewControl 来实现。这样一来，就可以降低业务代码与渲染视图之间的耦合度，让各个模块各司其职，同时也保证了代码的简洁。\r\n\r\n重构这个项目是一个漫长且痛苦的过程，因为我先前写的架构实在是过于混乱不堪了。不同模块之间、不同函数之间，充斥着随便的全局变量读写与杂乱无章的相互调用。实际上，在现在的版本中，许多问题并没有得到完全改善，所以在接下来的工作中，还需要继续优化以改善现有项目的结构状况。\r\n\r\n"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"2021-10-24-WG_3.markdown"},"buildId":"HXrOUhiN06_k-DjdnFR0c","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>